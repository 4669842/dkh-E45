<?xml version="1.0" encoding="Windows-1252"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:ignoredWords="essupport" MadCap:tocPath="Development|Commands Reference|Commands" MadCap:InPreviewMode="false" MadCap:PreloadImages="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="HtmlHelp" MadCap:PathToHelpSystem="../" MadCap:HelpSystemFileName="vfiles.xml" MadCap:SearchType="Stem">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=7,8,9,10" />
        <meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
        <meta http-equiv="Content-Language" content="en-UK" /><title>&amp;Script</title>
        <link href="../SkinSupport/Slideshow.css" rel="stylesheet" />
        <link href="../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../Resources/TableStyles/SimpleDarkBackground.css" rel="stylesheet" />
        <link href="../Resources/Stylesheets/styles.css" rel="stylesheet" />
        <script src="../SkinSupport/jquery.js">
        </script>
        <script src="../SkinSupport/MadCapGlobal.js">
        </script>
        <script src="../SkinSupport/MadCapSlideshow.js">
        </script>
        <script src="../SkinSupport/MadCapMerging.js">
        </script>
        <script src="../SkinSupport/MadCapAliasFile.js">
        </script>
        <script src="../SkinSupport/MadCapUtilities.js">
        </script>
        <script src="../SkinSupport/MadCapEffects.js">
        </script>
        <script src="../SkinSupport/MadCapEffectsMenu.js">
        </script>
        <script src="../SkinSupport/MadCapBody.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapHighlighter.js" type="text/javascript">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../Development.htm">Development</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../Commands_Reference.htm">Commands Reference</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="Commands.htm">Commands</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">&amp;Script</span>
        </div>
        <h1><a name="kanchor1551"></a>&amp;Script</h1>
        <h2>Syntax &#160;&#160;&#160;<a href="../Scripting/Syntax_Notation.htm" title="Syntax Notation"><img src="../Images/Icon_Info.png" alt="" style="border: none;" /></a></h2>
        <p class="Script">[&amp;Script]</p>
        <p><a href="#Examples" class="selected">Example&#160;Scripts</a>
        </p>
        <h2>Description</h2>
        <p><a name="kanchor1552"></a>The &amp;Script command enables developers to integrate with third party 
 products by calling and running external scripts. The &amp;Script command 
 can be used to embed a section of scripting such as a VBScript or Java 
 script, which links to a variety of external objects such as a SQL database, 
 XML objects, web services, COM objects, etc.</p>
        <h3>&amp;Script and Visualfiles Browser</h3>
        <p>&amp;Script command is supported in Visualfiles Browser but its use 
 is restricted because scripts run on the server not the client PC, which 
 means they behave differently. Using the &amp;Script command in Visualfiles 
 GUI, it is possible to run pop up windows, message boxes, launch applications 
 and do other things that interact with the user, since scripts are executed 
 on the client PC; however, this use is not possible in Visualfiles Browser.</p>
        <h3>&amp;Script Intermittently Crashes Visualfiles</h3>
        <p>There are occasions when use of the &amp;Script command causes Visualfiles to crash. This issue typically occurs when the called VBScript is waiting for responses or events, for example when calling web services. The problem is caused by the new .Net components introduced for the updated Visualfiles user interface.</p>
        <p>When upgrading from earlier versions of Visualfiles we recommend that all occurrences of &amp;Script are fully tested prior to upgrading a production environment. It is possible to identify where any &amp;Script commands are used by running the DSearch Script Searcher. More information about this utility is available in the help system.</p>
        <p>It is still possible to use the &amp;Script command in situations that do not require a response from a third party system, but full testing is still recommended before an upgrade. To fully resolve any issues we recommend reengineering all problematic scripting and to use the more recent, updated commands, <a href="&amp;DotNet_Command.htm">&amp;DotNet</a>, <a href="&amp;call_command.htm">&amp;Call</a> and <a href="&amp;request_command.htm">&amp;Request</a>.</p>
        <table style="left: 0px;top: 13px;margin-top: 10px;" cellspacing="0" width="100%">
            <col style="width: 100%;" />
            <tr style="vertical-align: top;height: 18px;">
                <td style="border: Solid 1px #c0c0c0;background-attachment: scroll;background-image: url('../BckgrdBCT.gif');background-repeat: Repeat-X;width: 100%;padding-right: 10px;padding-left: 10px;" background="../BckgrdBCT.gif" bgcolor="#FFFFFF">
                    <p class="TableBannerHeading">Parameters</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 18px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">fields="LF01,LF15"</p>
                    <p>Enables Visualfiles temporary fields to be accessed from VBScripts 
		 using a comma delimited list of temporary fields. Fields are used 
		 to integrate results from VBScripts in the Visualfiles script.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 18px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">file=&lt;path+scriptname&gt;</p>
                    <p>Used to define the location and name of the VBScript to run. 
		 See <a href="#Examples" class="selected">example 5</a>.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 18px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">language="JavaScript"</p>
                    <p>The language used can be specified using this parameter. Currently 
		 VBScript and JavaScript are supported.</p>
                    <p class="note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #bed230;&quot; class=&quot;mcFormatColor&quot;&gt;Note: &lt;/span&gt;&lt;/b&gt;"><span class="autonumber"><span><b><span style="color: #bed230;" class="mcFormatColor">Note: </span></b></span></span> If this parameter 
		 is not specified the default language is VBScript.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 18px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">XML=XL01</p>
                    <p>This parameter enables XML to be shared between a Visualfiles 
		 scripts and VBScripts.</p>
                </td>
            </tr>
        </table>
        <h2 class="Script">Test if the &amp;Script Command Worked</h2>
        <p>The system variable <a href="../Scripting/status,_system_variable_-_error_trapping.htm">Status</a>, 
 can be used to return the status of the last execution of the &amp;Script 
 command.</p>
        <p>In the following example, the status of the &amp;Script command is reported 
 to indicate whether any errors occurred whilst data was being written 
 to the database.</p>
        <h4>Example</h4>
        <p class="Script">[&amp;Script file="c:\myscript.vbs"]</p>
        <p class="Script">[&amp;If Status(script) &lt;&gt; ""]</p>
        <p class="Script">&#160;&#160;[&amp;Message Status(script)]</p>
        <p class="Script">[&amp;EndIf]</p>
        <p>If the value returned value is blank, the command was executed successfully. 
 If an error message is returned, the command failed.</p>
        <h4><a name="Examples" id="Examples"></a>Example&#160;Scripts</h4>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t5">1 Run 
 a VBScript</a>
        </p>
        <div MadCap:targetName="t5" style="display: none;">
            <p class="Script">[&amp;Script "call msgbox("Hello from VBScript")"]</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t4">2 Fields 
 parameter</a>
        </p>
        <div MadCap:targetName="t4" style="display: none;">
            <p>Use this code to pass LF values from Visualfiles to VBScript and 
	 back again.</p>
            <p class="Script">[&amp;Assign LF01="This is data populated in 
	 the Visualfiles script"]</p>
            <p class="Script">[&amp;Assign LF02="This is more data populated 
	 in the Visualfiles script"]</p>
            <p class="Script">[&amp;Script fields="LF01,LF02","</p>
            <p class="Script">msgbox LF01</p>
            <p class="Script">msgbox LF02</p>
            <p class="Script">LF01="NEW value for LF01 set in VBScript"</p>
            <p class="Script">LF02="New value for LF02 set in VBScript"</p>
            <p class="Script">"]</p>
            <p class="Script">[&amp;Message "Back in Visualfiles script:</p>
            <p class="Script">LF01 is: "+LF01+"</p>
            <p class="Script">LF02 is: "+LF02]</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t3">3 File 
 parameter</a>
        </p>
        <div MadCap:targetName="t3" style="display: none;">
            <p>Use this code to call a vbs script directly</p>
            <p class="Script">[&amp;Script file="c:\myscript.vbs"]</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t2">4 Create 
 and populate a grid using VBScript</a>
        </p>
        <div MadCap:targetName="t2" style="display: none;">
            <p>This script creates and populates a grid using VBScript in conjunction 
	 with the &amp;Script and the <a href="&amp;Sub_command.htm">&amp;Sub</a> 
	 commands.</p>
            <p class="Script">* Create Grid *</p>
            <p class="Script">[&amp;Grid action="create"]</p>
            <p class="Script">[&amp;Grid action="create-col",name = "First 
	 Col",format="x(35)",type="char",index]</p>
            <p class="Script">[&amp;Grid action="create-col",name = "Second 
	 Col",format="x(35)",type="char"]</p>
            <p class="Script">[&amp;Grid action="create-col",name = "Third 
	 Col",format="x(10)",type="char"]</p>
            <p class="Script">&#160;</p>
            <p class="Script">* Call VBScript to create data *</p>
            <p class="Script">[&amp;Script " visualfiles.callsub "createGridRow",array("one","two","three")</p>
            <p class="Script">&#160;visualfiles.callsub "createGridRow",array("Another 
	 one","Another two","Another three")"]</p>
            <p class="Script">[&amp;If status(script) &lt;&gt; ""]</p>
            <p class="Script">&#160;&#160;[&amp;Message "VBScript error:" 
	 + status(script)]</p>
            <p class="Script">[&amp;EndIf]</p>
            <p class="Script">&#160;</p>
            <p class="Script">* Display grid *</p>
            <p class="Script">[&amp;Grid action="display",title="My 
	 Grid",result=LF01,response=LF02,rows="15"]</p>
            <p class="Script">[&amp;Sub createGridRow]</p>
            <p class="Script">&#160;</p>
            <p class="Script">&#160;* Create grid row from within VBScript *</p>
            <p class="Script">&#160;&#160;[&amp;Grid action="create-row"]</p>
            <p class="Script">&#160;&#160;[&amp;Assign GR01=PI01] * Data from VBScript</p>
            <p class="Script">&#160;&#160;[&amp;Assign GR02=PI02]</p>
            <p class="Script">&#160;&#160;[&amp;Assign GR03=PI03]</p>
            <p class="Script">[&amp;EndSub]</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t1">5 Supply 
 &amp;Script file parameter using &amp;Declare</a>
        </p>
        <div MadCap:targetName="t1" style="display: none;">
            <p>This script enables you to dynamically supply the &amp;Script file 
	 parameter using the &amp;Declare command:</p>
            <p class="Script">[&amp;Declare field1="c:\temp\test.vbs"]</p>
            <p class="Script">[&amp;Script file="{field1}"]</p>
            <p class="Script">[&amp;If status(script) &lt;&gt; ""]</p>
            <p class="Script">[&amp;Message status(script)]</p>
            <p class="Script">[&amp;EndIf]</p>
        </div>
        <h4>Developers' Tip</h4>
        <p>Fields can be assigned more user friendly names when data is passed 
 from Visualfiles and VBScript and back again using temporary fields, for 
 example:</p>
        <p class="Script">[&amp;Assign LF01;"FieldName"="This is 
 data populated in the Visualfiles script"]</p>
        <div class="FooterTable">
            <table style="width: 100%;mc-table-style: url('../Resources/TableStyles/SimpleDarkBackground.css');margin-left: 0;margin-right: auto;" cellspacing="0" class="TableStyle-SimpleDarkBackground" summary="LexisNexis Visualfiles Information">
                <col style="width: 50%;" class="TableStyle-SimpleDarkBackground-Column-Column1" />
                <col class="TableStyle-SimpleDarkBackground-Column-Column1" style="width: 50%;" />
                <tbody>
                    <tr class="TableStyle-SimpleDarkBackground-Body-Row1">
                        <td class="TableStyle-SimpleDarkBackground-BodyB-Column1-Row1">
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_0" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Follow Us</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_0" style="display: none;">
                                    <p style="text-align: left;margin-top: 0;"><a href="https://twitter.com/LexisNexisES" class="Image" target="_blank" title="LexisNexis Enterprise Solutions" alt="LexisNexis Enterprise Solutions"><img src="../Resources/Images/twitter_icon_32x32.png" class="NoThumbnailHyperlinkedImage" alt="Twitter" /></a><a href="https://www.linkedin.com/groups/4909675" class="Image" target="_blank" title="Visualfiles" alt="LexisNexis"> <img src="../Resources/Images/linkedin_icon_32x32.png" class="NoThumbnailHyperlinkedImage" alt="LexisNexis LinkedIn" /></a> <a href="https://www.linkedin.com/company/2206" class="Image" target="_blank" title="LexisNexis" alt="LexisNexis"> <img src="../Resources/Images/linkedin_icon_32x32.png" class="NoThumbnailHyperlinkedImage" alt="LexisNexis LinkedIn" /></a> <a href="http://www.lexisnexis-es.co.uk/blog/" class="Image" target="_blank" title="LexisNexis Enterprise Solutions Blog" alt="LexisNexis Enterprise Solutions Blog"><img src="../Resources/Images/LN_KnowledgeBurst.png" class="NoThumbnailHyperlinkedImage" alt="LexisNexis" /></a></p>
                                </div>
                            </div>
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_1" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Visualfiles Feature Videos</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_1" style="display: none;">
                                    <p class="FooterTopicMaster"><a href="../Videos_-_Feature_Overviews.htm" target="_self">Videos Feature Overviews</a>
                                    </p>
                                </div>
                            </div>
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_2" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Documentation Feedback</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_2" style="display: none;">
                                    <p class="FooterTopicMaster">We update documentation based on your feedback. Please email your comments and suggestions to <script type="text/javascript">/*<![CDATA[*/var email=('documentation@lexisnexis.co.uk');
											var subject = "Feedback from Topic: " + escape(document.title);
											document.write('<a href="mailto:' + email +
									'?subject=' +subject+ '">' + 'Documentation Feedback' + '<'+'/a>');/*]]>*/</script>.</p>
                                </div>
                            </div>
                        </td>
                        <td class="TableStyle-SimpleDarkBackground-BodyA-Column1-Row1">
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_3" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Customer Support </a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_3" style="display: none;">
                                    <p class="FooterTopicMaster">Customer Support Portal <a href="http://www.essupport.lexisnexis.co.uk/portal/" target="_blank" class="footermasterlarge">http://www.essupport.lexisnexis.co.uk/portal/</a></p>
                                    <p class="FooterTopicMaster">Customer Support Phone: <span class="PrimaryCompanySupportPhoneNumber">+44(0)203 364 4555</span></p>
                                </div>
                            </div>
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_4" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Company Information</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_4" style="display: none;">
                                    <p class="FooterTopicMaster"><span class="PrimaryCompanyName">LexisNexis</span>
                                    </p>
                                    <p class="FooterTopicMaster"><span class="PrimaryCompanyStreetAddress">No. 3 City West Business Park, Gelderd Road</span>
                                    </p>
                                    <p class="FooterTopicMaster"><span class="PrimaryCompanyCityPostcode">Leeds, LS12 6LN</span>
                                    </p>
                                    <p class="FooterTopicMaster"><span class="PrimaryCompanyPhoneNumber">0113 2262031</span>
                                    </p>
                                </div>
                            </div>
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_5" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Product Information</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_5" style="display: none;">
                                    <p class="FooterTopicMaster"><span class="PrimaryProductFullName">Lexis® Visualfiles™</span> <span class="PrimaryProductVersionNumber">3.7</span></p>
                                    <p class="FooterTopicMaster">Copyright © <span class="PrimaryProductReleaseYear">2017</span>&#160;<span class="PrimaryCompanyName">LexisNexis</span>. All rights reserved.</p>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <script type="text/javascript" src="../SkinSupport/MadCapBodyEnd.js">
        </script>
    </body>
</html>