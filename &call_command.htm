<?xml version="1.0" encoding="Windows-1252"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:ignoredWords="essupport" MadCap:tocPath="Development|Commands Reference|Commands" MadCap:InPreviewMode="false" MadCap:PreloadImages="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="HtmlHelp" MadCap:PathToHelpSystem="../" MadCap:HelpSystemFileName="vfiles.xml" MadCap:SearchType="Stem">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=7,8,9,10" />
        <meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
        <meta http-equiv="Content-Language" content="en-UK" /><title>&amp;Call</title>
        <link href="../SkinSupport/Slideshow.css" rel="stylesheet" />
        <link href="../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../Resources/TableStyles/SimpleDarkBackground.css" rel="stylesheet" />
        <link href="../Resources/Stylesheets/styles.css" rel="stylesheet" />
        <script src="../SkinSupport/jquery.js">
        </script>
        <script src="../SkinSupport/MadCapGlobal.js">
        </script>
        <script src="../SkinSupport/MadCapSlideshow.js">
        </script>
        <script src="../SkinSupport/MadCapMerging.js">
        </script>
        <script src="../SkinSupport/MadCapAliasFile.js">
        </script>
        <script src="../SkinSupport/MadCapUtilities.js">
        </script>
        <script src="../SkinSupport/MadCapEffects.js">
        </script>
        <script src="../SkinSupport/MadCapEffectsMenu.js">
        </script>
        <script src="../SkinSupport/MadCapBody.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapHighlighter.js" type="text/javascript">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../Development.htm">Development</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../Commands_Reference.htm">Commands Reference</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="Commands.htm">Commands</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">&amp;Call</span>
        </div>
        <h1><a name="kanchor1353"></a>&amp;Call</h1>
        <h2>Syntax &#160;&#160;&#160;<a href="../Scripting/Syntax_Notation.htm" title="Syntax Notation"><img src="../Images/Icon_Info.png" alt="" style="border: none;" /></a></h2>
        <p class="Script">[<span style="font-weight: bold;">{</span>&amp;Call <span style="font-weight: bold;">&lt;</span>ScriptName<span style="font-weight: bold;">&gt;|&lt;</span>DocumentName<span style="font-weight: bold;">&gt;|&lt;</span>system.MyScript<span style="font-weight: bold;">&gt;}</span>]</p>
        <p><a href="#Examples" class="selected">Example&#160;Scripts</a>
        </p>
        <h2>Description</h2>
        <p><a name="kanchor1354"></a>Runs an additional script or document. Using the &amp;Call command helps 
 to create a modular format and prevents repetition of code as large scripts 
 are split into more manageable sections.</p>
        <p>Parameters can be passed to a called script using the <span style="font-weight: bold;">input</span> 
 parameter and system fields called <a href="#PI%20fields1" class="selected">PI fields</a>. 
 Values can be returned to the procedure using the <span style="font-weight: bold;">output</span> 
 parameter and system fields called <a href="#PO%20fields1" class="selected">PO fields</a>. 
 This provides the functionality to set up a generic script, called from 
 many scripts, that passes the results of processing back to different 
 fields.</p>
        <h3>System Prefix - Calling a System Script</h3>
        <p>To call a system script (e.g. MyScript), from a case script use the 
 prefix <span style="font-weight: bold;">system.</span>:</p>
        <p class="Script"><span class="ScriptChar">[&amp;Call system.MyScript]</span>
        </p>
        <h3>Calling a Script from a Temporary Field</h3>
        <p><span class="ScriptChar">[&amp;Assign TF01 = "</span><span class="ScriptChar" style="font-weight: bold;">&lt;</span><span class="ScriptChar">ScriptToCall</span><span class="ScriptChar" style="font-weight: bold;">&gt;</span><span class="ScriptChar">"]</span>
        </p>
        <p><span class="ScriptChar">[&amp;Call TF01]</span>
        </p>
        <p>&lt;<span style="font-weight: bold;">ScriptToCall</span>&gt; must be 
 a valid system script and must be contained within speech marks.</p>
        <p>This facility cannot be used with Laserform.</p>
        <h3>Add-ins</h3>
        <p>The <a href="#source" class="selected">Source</a> parameter enables developers to specify 
 the location of the script being called and to build up a library of scripts 
 which can be called from anywhere in the application. When the source 
 parameter is used the called script is retrieved from the specified location, 
 but when it is run, the script behaves as if it exists in the location 
 it is called from, see <a href="#Examples" class="selected">example 5</a>.</p>
        <h3>Subroutines</h3>
        <p>The &amp;Call command can be used to initiate a subroutine defined using 
 the <a href="&amp;Sub_command.htm">&amp;Sub</a> command.</p>
        <p>It can also used to specify a subroutine to run in another script. See 
 <a href="#Examples" class="selected">example 8</a>.</p>
        <h3>Call a Stored Procedure</h3>
        <p>Using VBL it is possible to call out to a system connected to Visualfiles and to execute one of its stored procedures that requests data back to 
 Visualfiles. This feature utilises the &amp;Call command's <span style="font-weight: bold;">dsn</span>, 
 <span style="font-weight: bold;">procedure</span> and <span style="font-weight: bold;">ParameterList</span> 
 parameters, which are used to invoke other VBL scripts or sub-routines 
 within VBL scripts. &#160;See <a href="#Examples" class="selected">examples 11 - 13</a>.</p>
        <p class="note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #bed230;&quot; class=&quot;mcFormatColor&quot;&gt;Note: &lt;/span&gt;&lt;/b&gt;"><span class="autonumber"><span><b><span style="color: #bed230;" class="mcFormatColor">Note: </span></b></span></span>It is also possible 
 to silently publish a message from Visualfiles at any point using <a href="&amp;Publish_command.htm">&amp;Publish</a>.</p>
        <p>If you are using an AppServer, the DSN needs to be set up on the server running the OpenEdge AppServer. If no AppServer is used, then the DSN needs to be set up on each client machine and thin client server.</p>
        <p>In addition, if an AppServer is used the service/user account that the OpenEdge Admin Service is running under needs the appropriate permissions to the server and database that the DSN is configured to use. If no AppServer is used then each individual user needs the appropriate permissions.</p>
        <h3><a name="Configuration_dsn_parametere"></a>Configuration required for using the dsn= Parameter</h3>
        <p>There are no prerequisite modules or system parameters required to use the dsn= parameter; however, there are both AppServer and ODBC driver related considerations.</p>
        <p>The SQL Server ODBC driver used to create the System DSN is dependent on the Operating System on the database server, or the server where the Visualfiles AppServer is located; for example select the 32bit driver for a 32bit Windows Server OS, but for a 64bit Windows Server OS, select the 64bit driver.</p>
        <p>Next, create the System DSN on the Visualfiles AppServer machine (e.g. database server) to facilitate the ODBC connection for Visualfiles users who have the <a href="../access_rights_in_detail.htm#Appserver">AppServer</a> user access right enabled. For all Visualfiles user accounts that do not have this permission, the System DSN is picked up locally on their machines. It is prudent to also create the System DSN on all the local machines of the users who are not configured for the AppServer, but also as a fall back for AppServer-configured users if the connection to the AppServer is lost.</p>
        <p>You must set which users connect into the SQL instance so when configuring your System DSN you can use Windows Authentication (i.e. Single Sign On). </p>
        <p>You also need to ensure that the account used to run the Admin Service on the Visualfiles AppServer (e.g. database server) also has sufficient permissions to access the SQL database. Instead, you can create a specific account against the SQL database with read and write permissions and then configure the System DSN to use that SQL account for communicating with the SQL database.</p>
        <table style="left: 0px;top: 13px;margin-top: 10px;" cellspacing="0" width="100%">
            <col style="width: 100%;" />
            <tr style="vertical-align: top;height: 19px;">
                <td style="border: Solid 1px #c0c0c0;background-attachment: scroll;background-image: url('../BckgrdBCT.gif');background-repeat: Repeat-X;width: 100%;padding-right: 10px;padding-left: 10px;" background="../BckgrdBCT.gif" bgcolor="#FFFFFF">
                    <p class="TableBannerHeading">Parameters</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 39px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">appserver</p>
                    <p>Nominate a script to run on the AppServer. Scripts always 
		 run on the client PC unless specifically coded to run on the AppServer. 
		 However, you really must understand the concept of the AppServer 
		 and what can potentially go wrong: possible data corruption or 
		 the PC may freeze.</p>
                    <p>The script called on the AppServer must not have any TF fields 
		 or expect other database fields, that were available in the calling 
		 script, to be available.</p>
                    <p>A script on the AppServer should be generic, comprehensively 
		 tested, and work with a set of input parameters - no form of output 
		 whatsoever. Be sure there are no &amp;Message statements or any 
		 other command that can lead to user input; for example, &amp;Select 
		 or &amp;Conflict.</p>
                    <p class="Warning"><span class="WarningColor">Caution</span>: The 
		 <span class="ScriptChar" style="font-weight: bold;">appserver</span> parameter will not work 
		 in all circumstances. Scripts should be thoroughly tested: it 
		 may be that a script will not run successfully on the AppServer
		 and processing must revert to the PC instead.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 39px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">complete</p>
                    <p>Assign this parameter to &amp;Call to ensure the script that 
		 runs after the command is processed even if the called script 
		 ran a button script from the &amp;Show command.</p>
                    <p>In a script including the &amp;Call command which called another 
		 script that ran a &amp;Show command to assign a script to a button; 
		 when the button is selected the button script runs but both the 
		 scripts are terminated immediately. This is intended behaviour 
		 but in an earlier release of Visualfiles the initiating script 
		 with the &amp;Call command continued and perform all subsequent 
		 commands in the script. In order to provide backwards compatibility 
		 (for Visualfiles GUI users) the <span style="font-weight: bold;">complete</span> 
		 parameter is assigned to the &amp;Call command to ensure that 
		 the script that runs after &amp;Call is processed, even if the 
		 called script ran a button script from the <a href="&amp;show_command.htm">&amp;Show</a> 
		 command. See <a href="#Examples" class="selected">example 10</a>.</p>
                </td>
            </tr>
            <tr>
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script"><a name="dsn" id="a11"></a>dsn 
		 = <span style="font-weight: bold;">&lt;</span>dsn_code<span style="font-weight: bold;">&gt;</span></p>
                    <p>Specify the DSN connection code to the SQL database containing 
		 a stored procedure. See <a href="#Examples" class="selected">example 11</a>.</p>
                    <p>Used in combination with the <span style="font-weight: bold;">procedure</span>&#160;and 
		 &lt;<span style="font-weight: bold;">parameterList</span>&gt;parameter to call a stored 
		 procedure. </p>
                    <p class="note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #bed230;&quot; class=&quot;mcFormatColor&quot;&gt;Note: &lt;/span&gt;&lt;/b&gt;"><span class="autonumber"><span><b><span style="color: #bed230;" class="mcFormatColor">Note: </span></b></span></span>For more information using this parameter go <a href="#Configuration_dsn_parametere" class="selected">to Configuration required for using the dsn= Parameter</a>.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 39px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script"><a name="kanchor1355"></a><a name="icon" id="icon"></a>icon 
		 = "<span style="font-weight: bold;">&lt;</span>Data<span style="font-weight: bold;">&gt;</span>"</p>
                    <p>Specify the icon number to call. See <a href="#Examples" class="selected">example 
		 9</a>.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 39px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">input = "<span style="font-weight: bold;">&lt;</span>Data<span style="font-weight: bold;">&gt;</span>"</p>
                    <p>Pass data from one process to another called process. It may 
		 be repeated to pass more than one piece of data to the called 
		 script or document.</p>
                    <p>When specifying information via the <span style="font-weight: bold;">input</span> 
		 parameter, the called process will use <a href="#PI%20fields1" class="selected">PI 
		 fields</a> to obtain the data. The first field specified is PI01, 
		 the second PI02, the third PI03 and so on.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 39px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">next-action={text_expression}</p>
                    <p>This parameter is used to end the script run at this point. 
		 Any code after the &amp;Grid command is ignored and the script 
		 specified by the text expression in the next-action parameter 
		 is run.</p>
                    <p>Text expressions are used to name the required script and can 
		 be constructed from any combination of the following:</p>
                    <ul>
                        <li class="p-BulletedList" value="1">
                            <p class="BulletedList"><span class="ScriptChar">"constant 
			 text"</span>, such as a script name</p>
                        </li>
                        <li class="p-BulletedList" value="2">
                            <p class="BulletedList"><span class="ScriptChar">'User 
			 input'</span>
                            </p>
                        </li>
                        <li class="p-BulletedList" value="3">
                            <p class="BulletedList">Database 
			 fields</p>
                        </li>
                        <li class="p-BulletedList" value="4">
                            <p class="BulletedList">LF, TF, 
			 PI fields. The temporary field specified will contain the 
			 value entered by the user.</p>
                        </li>
                    </ul>
                    <p class="note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #bed230;&quot; class=&quot;mcFormatColor&quot;&gt;Note: &lt;/span&gt;&lt;/b&gt;"><span class="autonumber"><span><b><span style="color: #bed230;" class="mcFormatColor">Note: </span></b></span></span>For more information 
		 on stateless scripting options go to <a href="../Scripting/Visualfiles_Browser_Environment.htm#no_wait_next_action_Parameters">no-wait 
		 and next-action Parameters</a> and <a href="../Scripting/Visualfiles_Browser_Environment.htm">Visualfiles 
		 Browser Environment</a>.</p>
                    <p class="note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #bed230;&quot; class=&quot;mcFormatColor&quot;&gt;Note: &lt;/span&gt;&lt;/b&gt;"><span class="autonumber"><span><b><span style="color: #bed230;" class="mcFormatColor">Note: </span></b></span></span>It is not 
		 possible to reference the GR fields in a script called using the 
		 <span style="font-weight: bold;">next-action</span> parameter. 
		 Too reference the GR fields, loop through the information held 
		 in the result= parameter; for example, result=LF01.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 39px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">next-action-inputs={expression};{expression}...</p>
                    <p>List of semi-colon delimited items to be passed as PI fields 
		 into the next-action script.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 39px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">no-wait</p>
                    <p>Enable the current process to continue whilst a called process 
		 is running, for example, a process that calls a document can continue 
		 whilst the document is processing.</p>
                    <p class="note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #bed230;&quot; class=&quot;mcFormatColor&quot;&gt;Note: &lt;/span&gt;&lt;/b&gt;"><span class="autonumber"><span><b><span style="color: #bed230;" class="mcFormatColor">Note: </span></b></span></span>The legacy 
		 format of this parameter is <span class="ScriptChar">nowait</span> 
		 which is still supported in older scripts.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 39px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">output = "<span style="font-weight: bold;">&lt;</span>Data<span style="font-weight: bold;">&gt;</span>"</p>
                    <p>Pass data from the called process back to the source process. 
		 It may be repeated to pass more than one piece of data to the 
		 calling script or document.</p>
                    <p>When specifying information via the <span style="font-weight: bold;">output</span> 
		 parameter, the calling process will use <a href="#PO%20fields1" class="selected">PO 
		 fields</a> to obtain the data. The first field specified is PO01, 
		 the second PO02, the third PO03 and so on.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 39px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script"><a name="owner" id="owner"></a>owner</p>
                    <p>Used to reference file level data from an add-in. See <a href="#Examples" class="selected">example 
		 5</a>.</p>
                </td>
            </tr>
            <tr>
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">&lt;ParameterList&gt;</p>
                    <p>Used to define a delimited list of zero or more input parameters 
		 required by the stored procedure.</p>
                    <h3>ParameterList Syntax:</h3>
                    <p class="Script">&lt;DataValue&gt;{name=&lt;ParameterName&gt;, 
		 type=&lt;NUM|N|INT|I|DEC|DATE|D|BOOL|B|LOG|L|TEXT|T&gt;}</p>
                    <p><span class="ScriptChar">DataValue</span>: Either a hard coded 
		 value or a VBL scripting variable containing a value.</p>
                    <p><span class="ScriptChar">Name=</span>: The name of the parameter 
		 as defined in the stored procedure.</p>
                    <p><span class="ScriptChar">Type=</span>: The parameters data type. 
		 &#160;</p>
                    <p>See <a href="#Examples" class="selected">example 12</a>.</p>
                </td>
            </tr>
            <tr>
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script"><a name="procedure" id="a12"></a>procedure 
		 = "<span style="font-weight: bold;">&lt;</span>procedure_name"<span style="font-weight: bold;">&gt;</span></p>
                    <p>The name of the stored procedure to call. See <a href="#Examples" class="selected">example 
		 11</a>.</p>
                    <p>Used in combination with the <span style="font-weight: bold;">dsn</span> 
		 and &lt;<span style="font-weight: bold;">parameterList</span>&gt; 
		 parameters to call a stored procedure. </p>
                    <p>You can define a comma delimited list of input parameters after 
		 the procedure parameter in the following format:</p>
                    <p class="Script" style="margin-left: 40px;"><span style="font-weight: bold;">&lt;</span>value<span style="font-weight: bold;">&gt;</span>{Name="<span style="font-weight: bold;">&lt;</span>parametername<span style="font-weight: bold;">&gt;</span>",type="<span style="font-weight: bold;">&lt;</span>type<span style="font-weight: bold;">&gt;</span>"}</p>
                    <p>The <span class="ScriptChar">parametername</span> is the name 
		 of the input parameter in the stored procedure.</p>
                    <p>The <span class="ScriptChar">type</span> can be either: </p>
                    <p><span class="ScriptChar">"num"</span>, &#160;<span class="ScriptChar">"N"</span>, <span class="ScriptChar">"int"</span>, 
		 <span class="ScriptChar">"I"</span>, <span class="ScriptChar">"dec"</span>, 
		 <span class="ScriptChar">"date"</span>, <span class="ScriptChar">"D"</span>, 
		 <span class="ScriptChar">"Bool"</span>, <span class="ScriptChar">"B"</span>, 
		 <span class="ScriptChar">"Log"</span>, <span class="ScriptChar">"l"</span>. 
		 </p>
                    <p>You can have any number of input parameters as long as they 
		 match the stored procedure.</p>
                    <p>Include Status(call) in the script to verify its success or 
		 failure when run.</p>
                    <p>Results are returned into a grid.</p>
                    <p>Either Display the grid or parse via &amp;ForEach GR.</p>
                    <p>Each row of data returned from the stored procedure create a 
		 GR row.</p>
                    <p>View a <a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t15">Sample Stored Procedure</a>.</p>
                    <div MadCap:targetName="t15" style="display: none;">
                        <p>Create a SQL Database and Table.</p>
                        <p>Amend this script where /*highlighted*/.</p>
                        <p>&#160;</p>
                        <p>USE [SQLAdaptor] /* DataBase Name */</p>
                        <p>GO</p>
                        <p>SET ANSI_NULLS ON</p>
                        <p>GO</p>
                        <p>SET QUOTED_IDENTIFIER ON</p>
                        <p>GO</p>
                        <p>CREATE PROCEDURE [dbo].[TEST_SP_TWO] /* Stored Procedure Name */</p>
                        <p>@MaxResults integer /* input parameters */</p>
                        <p>AS</p>
                        <p>if @MaxResults = 0</p>
                        <p>Select Top 100 Direction , Field_Values from tbl_SL_ServiceMessage   /* Fields to return */</p>
                        <p>else</p>
                        <p>Select Top (@MaxResults) * from tbl_SL_ServiceMessage</p>
                        <p>SET ROWCOUNT 0</p>
                        <p>return</p>
                        <p>GO</p>
                    </div>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 39px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script"><a name="source" id="source"></a>server= "<b>&lt;</b>data<b>&gt;</b>"</p>
                    <p>Specify the server for the DSN connection. See <a href="#Examples" class="selected">example 11</a>.</p>
                    <p class="note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #bed230;&quot; class=&quot;mcFormatColor&quot;&gt;Note: &lt;/span&gt;&lt;/b&gt;"><span class="autonumber"><span><b><span style="color: #bed230;" class="mcFormatColor">Note: </span></b></span></span>The server parameter maybe required when a DSN is used to call a stored procedure on a remote server. </p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 39px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script"><a name="source" id="source"></a>source</p>
                    <p>Specify the location of the called script or document. See <a href="#Examples" class="selected">example 6</a>.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 39px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script"><span style="font-weight: bold;">&lt;</span>DocumentName<span style="font-weight: bold;">&gt;</span></p>
                    <p>Specify the document to be called.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 39px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script"><span style="font-weight: bold;">&lt;</span>ScriptName<span style="font-weight: bold;">&gt;</span></p>
                    <p>Specify the script to be called.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 39px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script"><span style="font-weight: bold;">&lt;</span>system.ScriptName<span style="font-weight: bold;">&gt;</span></p>
                    <p>Specify the system script to be called.</p>
                    <p class="note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #bed230;&quot; class=&quot;mcFormatColor&quot;&gt;Note: &lt;/span&gt;&lt;/b&gt;"><span class="autonumber"><span><b><span style="color: #bed230;" class="mcFormatColor">Note: </span></b></span></span>When the <span style="font-weight: bold;">system</span> parameter is used to 
		 call a system script, it is only run against the file that it 
		 is called from, not at system level.</p>
                </td>
            </tr>
        </table>
        <h2><a name="PI fields1"></a>PI fields</h2>
        <p>To reduce the potential for a script to fail or return the wrong results 
 because a TF is being used in more than one place for more than one thing, 
 data passed from a script is accessible via system fields called PI fields. 
 Each script is initialised with its own unique set of PI fields. The input 
 parameters are stored in these fields for use within the script. The PI 
 fields expire when the script is complete.</p>
        <p>If the following message opens, 'Error: Input Parameter field n not 
 assigned' (where <span style="font-weight: bold;">n</span> is the number 
 of the input parameter field), it indicates that no input value has been 
 assigned to the appropriate field.</p>
        <p>Multiple parameters can be passed to a called script, including DB and 
 TF fields: these parameters are stored in the PI fields in the order in 
 which they are passed. For example,</p>
        <p class="Script">[&amp;Assign TF01 = "Data3"]</p>
        <p class="Script">[&amp;Call SCRIPT_A,input = "Data1",input = 
 "Data2",input = TF01]</p>
        <p>&#160;would Return:</p>
        <p class="Script">[&amp;Message PI01] - Would return: "Data1"</p>
        <p class="Script">[&amp;Message PI02] - Would return: "Data2"</p>
        <p class="Script">[&amp;Message PI03] - Would return: "Data3"</p>
        <p>Further,</p>
        <p class="Script">***CALLING SCRIPT</p>
        <p class="Script">[&amp;Call SCRIPT,input = "11/11/2003",input 
 = "CLIENT_CLIENT",input = ABC01]</p>
        <p class="Script">*** CALLED SCRIPT</p>
        <p class="Script">[&amp;Message "Documents are due on "+PI01+". 
 Three copies are required"]</p>
        <p class="Script">[&amp;SelectRelation type = PI02,ref = "Clt"]</p>
        <p class="Script">[&amp;Assign Clt.XYZ01 = PI03]</p>
        <h2><a name="PO fields1"></a>PO fields</h2>
        <p>To reduce the potential for a script to fail or return the wrong results 
 because a TF is being used in more than one place for more than one thing, 
 the &amp;Call command can specify output parameters known as PO fields. 
 These are values that are returned from the called procedure and should 
 be used in preference to temporary fields (TF).</p>
        <p>Be aware that PO fields are completely local to each script being run: 
 at the end of the called script, the PO fields are restored to their status 
 before the &amp;Call statement.</p>
        <p>For example, if the script <span style="font-weight: bold;">MYSCRIPT</span> 
 contains:</p>
        <p class="Script">[&amp;Assign PO01 = "Test1"]</p>
        <p class="Script">[&amp;Assign PO02 = 123]</p>
        <p>then,</p>
        <p class="Script">[&amp;Call MYSCRIPT,output = TF01,output = TF02]</p>
        <p class="Script">[&amp;Message TF01] " would return: Test1</p>
        <p class="Script">[&amp;Message TF02] " would return: 123</p>
        <h2>Test if the &amp;Call Command Worked</h2>
        <p>The system variable <a href="../Scripting/status,_system_variable_-_error_trapping.htm">Status</a>, 
 can be used to return the status of the last execution of the &amp;Call 
 command.</p>
        <p>In this <a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t14">example</a>, 
 the status of the &amp;Call command is reported to indicate whether any 
 errors occurred whilst data was being written to the database.</p>
        <div MadCap:targetName="t14" style="display: none;">
            <p>This code calls the script L-OPS-TT.</p>
            <p class="Script">[&amp;Call L-OPS-TT]</p>
            <p class="Script">[&amp;If Status(call) &lt; &gt; ""]</p>
            <p class="Script">&#160;&#160;[&amp;Message Status(call)]</p>
            <p class="Script">[&amp;EndIf]</p>
            <p>If the returned value is blank, the command was executed successfully. 
	 If an error message is returned, the command failed.</p>
        </div>
        <h4><a name="Examples" id="Examples"></a>Example&#160;Scripts</h4>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t13">1 Call a script</a>
        </p>
        <div MadCap:targetName="t13" style="display: none;">
            <p>Create a SQL Database and Table. </p>
            <p>Amend this script where /*highlighted*/.</p>
            <p>&#160;</p>
            <p class="Script">USE [SQLAdaptor] /* DataBase Name */</p>
            <p class="Script">GO</p>
            <p class="Script">SET ANSI_NULLS ON</p>
            <p class="Script">GO</p>
            <p class="Script">SET QUOTED_IDENTIFIER ON</p>
            <p class="Script">GO</p>
            <p class="Script">CREATE PROCEDURE [dbo].[TEST_SP_TWO] /* Stored 
			 Procedure Name */</p>
            <p class="Script">@MaxResults integer /* input parameters */</p>
            <p class="Script">AS</p>
            <p class="Script">if @MaxResults = 0 </p>
            <p class="Script">Select Top 100 Direction , Field_Values from 
			 tbl_SL_ServiceMessage &#160;&#160;/* Fields to return */</p>
            <p class="Script">else</p>
            <p class="Script">Select Top (@MaxResults) * from tbl_SL_ServiceMessage 
			 </p>
            <p class="Script">SET ROWCOUNT 0</p>
            <p class="Script">return </p>
            <p class="Script">GO</p>
            <p>This script asks a user if they would like to send an email to the 
	 customer. If the user responds <span style="font-weight: bold;">Yes</span>, 
	 the script calling the email command is called.</p>
            <p class="Script">[&amp;If 'Do you wish to send an email to the Customer?'(Question) 
	 = "Yes"]</p>
            <p class="Script">&#160;&#160;&#160;[&amp;Call EM-CUST-GEN]</p>
            <p class="Script">[&amp;EndIf]]</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t12">2 Using input and PI Fields</a>
        </p>
        <div MadCap:targetName="t12" style="display: none;">
            <p class="Script">[&amp;Assign TF01 = "Data3"]</p>
            <p class="Script">[&amp;Call SCRIPT_A,input = "Data",input 
	 = TF01]</p>
            <p class="Script">***from SCRIPT_A:</p>
            <p class="Script">[&amp;Message PI01] - Would return: "Data"</p>
            <p class="Script">[&amp;Message PI02] - Would return: "Data3"</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t11">3 no-wait 
 parameter</a>
        </p>
        <div MadCap:targetName="t11" style="display: none;">
            <p>This code will call a letter, <span style="font-weight: bold;">Welcome 
	 letter to Customer</span>, but will not show the message until the 
	 letter is closed.</p>
            <p class="Script">[&amp;Call L-CUST-WEL]</p>
            <p class="Script">[&amp;Message "Please remember to print this 
	 letter immediately"]</p>
            <p>This code is similar and will call the same letter, however, this 
	 time it will continue running the rest of the script (because of the 
	 inclusion of the <span style="font-weight: bold;">no-wait</span> parameter), 
	 displaying the message before the document has finished processing.</p>
            <p class="Script">[&amp;Call L-OPS-TT,no-wait]</p>
            <p class="Script">[&amp;Message "Please remember to print this 
	 letter immediately"]</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t10">4 Call 
 system scripts</a>
        </p>
        <div MadCap:targetName="t10" style="display: none;">
            <p class="Script">[&amp;Call system.L-OPS-TT,nowait]</p>
            <p class="Script">[&amp;Message "Test2"]</p>
            <p class="note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #bed230;&quot; class=&quot;mcFormatColor&quot;&gt;Note: &lt;/span&gt;&lt;/b&gt;"><span class="autonumber"><span><b><span style="color: #bed230;" class="mcFormatColor">Note: </span></b></span></span>Adding the prefix 
	 <span style="font-weight: bold;">system</span> to the called script 
	 will call a system script.</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t9">5 Owner 
 parameter</a>
        </p>
        <div MadCap:targetName="t9" style="display: none;">
            <p>Calls the script <span style="font-weight: bold;">S-SCRIPT</span> 
	 on the file agenda.</p>
            <p class="Script"><span class="ScriptChar">[&amp;Call OWNER.S-SCRIPT]</span>
            </p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t8">6 Source 
 parameter</a>
        </p>
        <div MadCap:targetName="t8" style="display: none;">
            <p>When the source parameter is used, the called script is retrieved 
	 from the specified location. But when it is run, the script behaves 
	 as if it exists in the location it is called from. This example explains 
	 this point using two add-ins:</p>
            <p>Administration ADMINISTRATIONAA</p>
            <p>Sale Instructions SALEINSTAA</p>
            <p>The following script exists on the ADMINISTRATIONAA Add-in:</p>
            <p>Message Add-in Name S-ADMINISTRATIONAA-NAME</p>
            <p>The script contains the following code:</p>
            <p><span class="ScriptChar">[&amp;Message "Add-in Name: "+AI03]</span> 
	 *** Add-in name</p>
            <p>If this script is run from the ADMINISTRATIONAA add-in the result 
	 would be:</p>
            <p>Add-in Name: Administration</p>
            <p>If it is run from the SALEINSTAA add-in using the following code:</p>
            <p class="Script">[&amp;Call ADMINISTRATIONAA.S-ADMINISTRATIONAA-NAME]</p>
            <p>The result would be:</p>
            <p>Add-in Name: Administration</p>
            <p>However if it is run for the SALEINSTAA add-in using the call command 
	 with the new source parameter:</p>
            <p class="Script">[&amp;Call S-ADMINISTRATIONAA-NAME, source="ADMINISTRATIONAA"]</p>
            <p>Then the script is retrieved from the ADMINISTRATIONAA add-in but 
	 when it is run it behaves as if it exists on the SALEINSTAA add-in 
	 so the result would be:</p>
            <p>Add-in Name: Sale Instructions</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t7">7 Define 
 and call a subroutine</a>
        </p>
        <div MadCap:targetName="t7" style="display: none;">
            <p class="Script" style="margin-left: 40px;">[&amp;Call MySub]</p>
            <p class="Script">[&amp;Sub MySub]</p>
            <p class="Script">&#160;&#160;&#160;&#160;[&amp;Message "Hello"]</p>
            <p class="Script">[&amp;EndSub]</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t6">8 Specify 
 a subroutine to run in another script</a>
        </p>
        <div MadCap:targetName="t6" style="display: none;">
            <p>Script 1</p>
            <p class="Script">[&amp;Call MYSCRIPT/MYSUB]</p>
            <p>Script2</p>
            <p class="Script">(called MYSCRIPT )</p>
            <p class="Script">[&amp;Sub MYSUB]</p>
            <p class="Script">[&amp;Message "This is the internal sub"]</p>
            <p class="Script">[&amp;End sub]</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t5">9 Run 
 icon script</a>
        </p>
        <div MadCap:targetName="t5" style="display: none;">
            <p class="Script">[&amp;Call icon=17]</p>
            <p>This script runs the script associated to icon 17.</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t4">10 Complete 
 parameter</a>
        </p>
        <div MadCap:targetName="t4" style="display: none;">
            <p>When the complete parameter is assigned to the &amp;Call command, 
	 the script after the &amp;Call is also processed even if the called 
	 script ran a button script from the &amp;Show command.</p>
            <p class="Script">[&amp;Call Script-2,complete]</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t3">11 dsn 
 and procedure parameters</a>
        </p>
        <div MadCap:targetName="t3" style="display: none;">
            <p class="Script">[&amp;Assign LF01 = "adaptor"]</p>
            <p class="Script">[&amp;Call dsn=LF01 , procedure="TEST_SP_TWO" 
	 , 100{name="MaxResults" , type="N"}]</p>
            <p class="Script">[&amp;If status(call ) = ""]</p>
            <p class="Script">[&amp;Grid action = "display",title = "IPI 
	 IN Table",button1 = "Cancel",button2 = "Select",result 
	 = TF04,response = TF02,rows = 10,order = "descending"]</p>
            <p class="Script">[&amp;Else]</p>
            <p class="Script">[&amp;Message status(call)]</p>
            <p class="Script">[&amp;EndIf]</p>
            <p class="Script">&#160;</p>
            <p>Script used to bring across stages:</p>
            <p>&#160;</p>
            <p class="Script">split billing address.**********************************************************</p>
            <p class="Script">*** &#160;Script: TESTSCRIPT &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;***</p>
            <p class="Script">*** &#160;Called By: &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;***</p>
            <p class="Script">*** &#160;Calls: &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;***</p>
            <p class="Script">*** &#160;Created By: VF On 14/07/14 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;***</p>
            <p class="Script">********************************************************************************</p>
            <p class="Script">[&amp;Grid action="delete"]</p>
            <p class="Script">[&amp;Message "Testing procedure - "+quote+"Int_GetClientDetails"+quote+"."]</p>
            <p class="Script">[&amp;Assign LF01 = "Artiion"]</p>
            <p class="Script">[&amp;Call dsn=LF01,server="Yogi",procedure="Int_GetClientDetails","00001001"{name="@client"}]</p>
            <p class="Script">[&amp;If status(call ) = ""]</p>
            <p class="Script">&#160;&#160;[&amp;Grid action = "display",title 
	 = "IPI IN Table",button1 = "Cancel",button2 = 
	 "Next",result = TF04,response = TF02,rows = 10,order = "descending"]</p>
            <p class="Script">&#160;&#160;[&amp;If TF02="BUTTON1"]</p>
            <p class="Script">&#160;&#160;&#160;&#160;[&amp;Quit]</p>
            <p class="Script">&#160;&#160;[&amp;EndIf]</p>
            <p class="Script">[&amp;Else]</p>
            <p class="Script">&#160;&#160;[&amp;Message status(call)]</p>
            <p class="Script">[&amp;EndIf]</p>
            <p class="Script">[&amp;Call quit]</p>
            <p class="Script">[&amp;Message "Testing procedure - "+quote+"Int_GetMatterDetails"+quote+"."]</p>
            <p class="Script">[&amp;Assign LF01 = "Artiion"]</p>
            <p class="Script">[&amp;Call dsn=LF01,server="Yogi",procedure="Int_GetMatterDetails","00001001"{name="@client",type="x"},"00000001"{name="@matter",type="x"}]</p>
            <p class="Script">[&amp;If status(call ) = ""]</p>
            <p class="Script">&#160;&#160;[&amp;Grid action = "display",title 
	 = "IPI IN Table",button1 = "Cancel",button2 = 
	 "Next",result = TF04,response = TF02,rows = 10,order = "descending"]</p>
            <p class="Script">&#160;&#160;&amp;Message "Matter details for 
	 axxia client is ="+quote+GR01+quote+"."]</p>
            <p class="Script">&#160;&#160;[&amp;If TF02="BUTTON1"]</p>
            <p class="Script">&#160;&#160;&#160;&#160;[&amp;Quit]</p>
            <p class="Script">&#160;&#160;[&amp;EndIf]</p>
            <p class="Script">[&amp;Else]</p>
            <p class="Script">&#160;&#160;[&amp;Message status(call)]</p>
            <p class="Script">[&amp;EndIf]</p>
            <p class="Script">[&amp;Call quit]</p>
            <p class="Script">[&amp;Message "Testing procedure - "+quote+"Int_GetNextClientNumber"+quote+"."]</p>
            <p class="Script">[&amp;Assign LF01 = "Artiion"]</p>
            <p class="Script">[&amp;Call dsn=LF01 , server="Yogi", procedure="Int_GetNextClientNumber"]</p>
            <p class="Script">[&amp;If status(call ) = ""]</p>
            <p class="Script">&#160;&#160;[&amp;Message "Next axxia client 
	 number is ="+quote+GR01+quote+"."]</p>
            <p class="Script">[&amp;Else]</p>
            <p class="Script">&#160;&#160;[&amp;Message status(call)]</p>
            <p class="Script">[&amp;EndIf]</p>
            <p class="Script">[&amp;Call quit]</p>
            <p class="Script">[&amp;Message "Testing procedure - "+quote+"Int_GetNextMatterNumber"+quote+"."]</p>
            <p class="Script">[&amp;Assign LF01 = "Artiion"]</p>
            <p class="Script">[&amp;Assign LF02="00001001"]</p>
            <p class="Script">[&amp;Call dsn=LF01 , server="Yogi", procedure="Int_GetNextMatterNumber",LF02{name="@client"}]</p>
            <p class="Script">[&amp;If status(call ) = ""]</p>
            <p class="Script">&#160;&#160;[&amp;Message "Next matter number 
	 for axxia client "+LF02+" is ="+quote+GR01+quote+"."]</p>
            <p class="Script">[&amp;Else]</p>
            <p class="Script">&#160;&#160;[&amp;Message status(call)]</p>
            <p class="Script">[&amp;EndIf]</p>
            <p class="Script">[&amp;Sub QUIT]</p>
            <p class="Script">[&amp;If 'Run next procedure?'(question)="No"]</p>
            <p class="Script">&#160;&#160;&#160;[&amp;Quit]</p>
            <p class="Script">[&amp;EndIf]</p>
            <p class="Script">[&amp;EndSub]</p>
            <p class="Script">*** AMENDMENTS *****************************************************************</p>
            <p class="Script">Amendment By: &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Amendment:</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t2">12 Error 
 Handling</a>
        </p>
        <div MadCap:targetName="t2" style="display: none;">
            <p>Use the standard VBL error handling features to trap any errors 
	 raised by the &amp;Call command:</p>
            <p class="Script">[&amp;Call dsn="AccountsSystem", procedure="SPGetMTDesc, 
	 "1234"{name=mCode, type="T"}] </p>
            <p class="Script">[&amp;If status (call) &lt;&gt; ""]</p>
            <p class="Script">&#160;&#160;[&amp;Message status (call)]</p>
            <p class="Script">[&amp;EndIf]</p>
            <h3>Operation</h3>
            <p>This command requires a stored procedure defined in the connected 
	 system’s database with a set of input parameters matching those defined 
	 on the <a href="#" class="selected">&amp;Call</a> command. The stored 
	 procedure cannot have output parameters.</p>
            <p>To return data back to Visualfiles, the stored procedure must contain 
	 a SELECT statement whose record set will be returned into the VBL 
	 script as a "Grid" object. The VBL can then process the 
	 data using the standard <a href="&amp;grid_command.htm">&amp;Grid</a> 
	 commands and GR fields.</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t1">13 Call 
 a stored procedure</a>
        </p>
        <div MadCap:targetName="t1" style="display: none;">
            <p>Instruct Visualfiles to call an external connected system to return 
	 the matter description for a given matter code.</p>
            <p>Example stored procedure:</p>
            <p>&#160;</p>
            <p class="Script" style="margin-left: 40px;">USE [AccountsDatabase] 
	 &#160;</p>
            <p class="Script" style="margin-left: 40px;">GO</p>
            <p class="Script" style="margin-left: 40px;">SET ANSI_NULLS ON</p>
            <p class="Script" style="margin-left: 40px;">GO</p>
            <p class="Script" style="margin-left: 40px;">SET QUOTED_IDENTIFIER 
	 ON</p>
            <p class="Script" style="margin-left: 40px;">GO</p>
            <p class="Script" style="margin-left: 40px;">CREATE PROCEDURE [dbo].[SPGetMTDesc]</p>
            <p class="Script" style="margin-left: 40px;">@mCode varchar(10) </p>
            <p class="Script" style="margin-left: 40px;">AS</p>
            <p class="Script" style="margin-left: 40px;">Select Top 1 Description 
	 from dbo.MTtable where dbo.MTtable.MTCode = @mCode</p>
            <p class="Script" style="margin-left: 40px;">SET ROWCOUNT 0</p>
            <p class="Script" style="margin-left: 40px;">return </p>
            <p class="Script" style="margin-left: 40px;">GO</p>
            <p>&#160;</p>
            <p>The VBL syntax is:</p>
            <p class="Script">[&amp;Call dsn="AccountsSystem", procedure="SPGetMTDesc, 
	 "1234"{name=mCode, type="T"}] </p>
            <p class="Script">[&amp;If status (call) = ""]</p>
            <p class="Script">&#160;&#160;[&amp;ForEach GR]</p>
            <p class="Script">&#160;&#160;&#160;&#160;[&amp;Message "The description 
	 for Matter 1234 is: " + GR01]</p>
            <p class="Script">&#160;&#160;[&amp;EndFor]</p>
            <p class="Script">[&amp;Else]</p>
            <p class="Script">&#160;&#160;[&amp;Message "Error calling Stored 
	 Procedure: " + status (call)]</p>
            <p class="Script">[&amp;EndIf]</p>
        </div>
        <h4>Developers' Tip</h4>
        <p>When a script calls several documents, each &amp;Call command can be 
 suffixed with the <span style="font-weight: bold;">nowait</span> parameter 
 to allow subsequent documents and scripting to continue.</p>
        <p class="RelatedInfoHead">
            <img src="../redboxes.GIF" alt="" style="border: none;" /> <b>See also:</b></p>
        <ul>
            <li value="1"><a href="../Add-ins/Add-in_Editor.htm">Add-ins</a>
            </li>
            <li value="2"><a href="../Add-ins/Scripting_with_Add-ins.htm">Scripting with 
	 Add-ins</a>
            </li>
            <li value="3"><a href="&amp;Sub_command.htm">&amp;Sub</a>
            </li>
            <li value="4"><a href="../Scripting/Visualfiles_Browser_Environment.htm">Visualfiles 
	 Browser Environment</a>
            </li>
            <li value="5"><a href="../Integration_Framework.htm">Integration Framework</a>
            </li>
        </ul>
        <div class="FooterTable">
            <table style="width: 100%;mc-table-style: url('../Resources/TableStyles/SimpleDarkBackground.css');margin-left: 0;margin-right: auto;" cellspacing="0" class="TableStyle-SimpleDarkBackground" summary="LexisNexis Visualfiles Information">
                <col style="width: 50%;" class="TableStyle-SimpleDarkBackground-Column-Column1" />
                <col class="TableStyle-SimpleDarkBackground-Column-Column1" style="width: 50%;" />
                <tbody>
                    <tr class="TableStyle-SimpleDarkBackground-Body-Row1">
                        <td class="TableStyle-SimpleDarkBackground-BodyB-Column1-Row1">
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_0" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Follow Us</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_0" style="display: none;">
                                    <p style="text-align: left;margin-top: 0;"><a href="https://twitter.com/LexisNexisES" class="Image" target="_blank" title="LexisNexis Enterprise Solutions" alt="LexisNexis Enterprise Solutions"><img src="../Resources/Images/twitter_icon_32x32.png" class="NoThumbnailHyperlinkedImage" alt="Twitter" /></a><a href="https://www.linkedin.com/groups/4909675" class="Image" target="_blank" title="Visualfiles" alt="LexisNexis"> <img src="../Resources/Images/linkedin_icon_32x32.png" class="NoThumbnailHyperlinkedImage" alt="LexisNexis LinkedIn" /></a> <a href="https://www.linkedin.com/company/2206" class="Image" target="_blank" title="LexisNexis" alt="LexisNexis"> <img src="../Resources/Images/linkedin_icon_32x32.png" class="NoThumbnailHyperlinkedImage" alt="LexisNexis LinkedIn" /></a> <a href="http://www.lexisnexis-es.co.uk/blog/" class="Image" target="_blank" title="LexisNexis Enterprise Solutions Blog" alt="LexisNexis Enterprise Solutions Blog"><img src="../Resources/Images/LN_KnowledgeBurst.png" class="NoThumbnailHyperlinkedImage" alt="LexisNexis" /></a></p>
                                </div>
                            </div>
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_1" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Visualfiles Feature Videos</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_1" style="display: none;">
                                    <p class="FooterTopicMaster"><a href="../Videos_-_Feature_Overviews.htm" target="_self">Videos Feature Overviews</a>
                                    </p>
                                </div>
                            </div>
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_2" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Documentation Feedback</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_2" style="display: none;">
                                    <p class="FooterTopicMaster">We update documentation based on your feedback. Please email your comments and suggestions to <script type="text/javascript">/*<![CDATA[*/var email=('documentation@lexisnexis.co.uk');
											var subject = "Feedback from Topic: " + escape(document.title);
											document.write('<a href="mailto:' + email +
									'?subject=' +subject+ '">' + 'Documentation Feedback' + '<'+'/a>');/*]]>*/</script>.</p>
                                </div>
                            </div>
                        </td>
                        <td class="TableStyle-SimpleDarkBackground-BodyA-Column1-Row1">
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_3" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Customer Support </a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_3" style="display: none;">
                                    <p class="FooterTopicMaster">Customer Support Portal <a href="http://www.essupport.lexisnexis.co.uk/portal/" target="_blank" class="footermasterlarge">http://www.essupport.lexisnexis.co.uk/portal/</a></p>
                                    <p class="FooterTopicMaster">Customer Support Phone: <span class="PrimaryCompanySupportPhoneNumber">+44(0)203 364 4555</span></p>
                                </div>
                            </div>
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_4" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Company Information</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_4" style="display: none;">
                                    <p class="FooterTopicMaster"><span class="PrimaryCompanyName">LexisNexis</span>
                                    </p>
                                    <p class="FooterTopicMaster"><span class="PrimaryCompanyStreetAddress">No. 3 City West Business Park, Gelderd Road</span>
                                    </p>
                                    <p class="FooterTopicMaster"><span class="PrimaryCompanyCityPostcode">Leeds, LS12 6LN</span>
                                    </p>
                                    <p class="FooterTopicMaster"><span class="PrimaryCompanyPhoneNumber">0113 2262031</span>
                                    </p>
                                </div>
                            </div>
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_5" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Product Information</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_5" style="display: none;">
                                    <p class="FooterTopicMaster"><span class="PrimaryProductFullName">Lexis® Visualfiles™</span> <span class="PrimaryProductVersionNumber">3.7</span></p>
                                    <p class="FooterTopicMaster">Copyright © <span class="PrimaryProductReleaseYear">2017</span>&#160;<span class="PrimaryCompanyName">LexisNexis</span>. All rights reserved.</p>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <script type="text/javascript" src="../SkinSupport/MadCapBodyEnd.js">
        </script>
    </body>
</html>