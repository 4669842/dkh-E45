<?xml version="1.0" encoding="Windows-1252"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:ignoredWords="essupport" MadCap:tocPath="Development|Commands Reference|Commands" MadCap:InPreviewMode="false" MadCap:PreloadImages="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="HtmlHelp" MadCap:PathToHelpSystem="../" MadCap:HelpSystemFileName="vfiles.xml" MadCap:SearchType="Stem">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=7,8,9,10" />
        <meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
        <meta http-equiv="Content-Language" content="en-UK" /><title>&amp;Import</title>
        <link href="../SkinSupport/Slideshow.css" rel="stylesheet" />
        <link href="../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../Resources/TableStyles/SimpleDarkBackground.css" rel="stylesheet" />
        <link href="../Resources/Stylesheets/styles.css" rel="stylesheet" />
        <script src="../SkinSupport/jquery.js">
        </script>
        <script src="../SkinSupport/MadCapGlobal.js">
        </script>
        <script src="../SkinSupport/MadCapSlideshow.js">
        </script>
        <script src="../SkinSupport/MadCapMerging.js">
        </script>
        <script src="../SkinSupport/MadCapAliasFile.js">
        </script>
        <script src="../SkinSupport/MadCapUtilities.js">
        </script>
        <script src="../SkinSupport/MadCapEffects.js">
        </script>
        <script src="../SkinSupport/MadCapEffectsMenu.js">
        </script>
        <script src="../SkinSupport/MadCapBody.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapHighlighter.js" type="text/javascript">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../Development.htm">Development</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../Commands_Reference.htm">Commands Reference</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="Commands.htm">Commands</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">&amp;Import</span>
        </div>
        <h1><a name="kanchor1720"></a><a name="kanchor1721"></a>&amp;Import</h1>
        <h2>Syntax &#160;&#160;&#160;<a href="../Scripting/Syntax_Notation.htm" title="Syntax Notation"><img src="../Images/Icon_Info.png" alt="" style="border: none;" /></a></h2>
        <p class="Script">[&amp;Import filename = "FilePath"]<br />
&#160;&#160;&#160;...</p>
        <p class="Script">[&amp;EndImport]</p>
        <p><a href="#Examples" class="selected">Example&#160;Scripts</a>
        </p>
        <h2>Description</h2>
        <p><a name="kanchor1722"></a>An iterative command that imports data into the database. &amp;Import 
 must be terminated with an &amp;EndImport command.</p>
        <p>&amp;Import enables you to define record types when importing undelimited 
 records. See <a href="#Examples" class="selected">example 3</a>.</p>
        <p>&amp;Import scripts can only be run from <span style="font-weight: bold;">System 
 Scripts</span> on the <span style="font-weight: bold;">Development</span> 
 toolbar.</p>
        <p>By default, each line of imported text is divided into fields delimited 
 by a comma and prefixed with 'IF':</p>
        <p>A text file with this format:</p>
        <p class="Script">"0005","00005/1","Test file 
 description","14/08/1988"<br />
"00013","00013/1","Another file","01/01/1998"</p>
        <p>is divided into the following IF fields:</p>
        <p class="Script">IF01 = 00005<br />
IF02 = 00005/1<br />
IF03 = Test file description<br />
IF04 = 14/08/1998<br />
IF01 = 00013<br />
IF02 = 00013/1<br />
IF03 = Another file<br />
IF04 = 01/01/1998</p>
        <p class="note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #bed230;&quot; class=&quot;mcFormatColor&quot;&gt;Note: &lt;/span&gt;&lt;/b&gt;"><span class="autonumber"><span><b><span style="color: #bed230;" class="mcFormatColor">Note: </span></b></span></span> The &amp;Import command 
 imports information from a file on a line by line basis. If, in the file 
 being imported, a carriage return does not exist at the end of the line, 
 the information being imported is blanked. See <a href="#Examples" class="selected">example 
 2</a>.</p>
        <table style="left: 0px;top: 13px;margin-top: 10px;" cellspacing="0" width="100%">
            <col style="width: 100%;" />
            <tr style="vertical-align: top;height: 18px;">
                <td style="border: Solid 1px #c0c0c0;background-attachment: scroll;background-image: url('../BckgrdBCT.gif');background-repeat: Repeat-X;width: 100%;padding-right: 10px;padding-left: 10px;" background="../BckgrdBCT.gif" bgcolor="#FFFFFF">
                    <p class="TableBannerHeading">Parameters</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 18px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">Delimiter</p>
                    <p class="Script">[&amp;Import filename = "&lt;FilePath&gt;",delimiter 
		 = "&lt;DelimiterCharacter&gt;"] ...<br />
		[&amp;EndImport]</p>
                    <p>Declares which character or symbol will represent the end of 
		 a field.</p>
                    <p>Each line of imported text is split into fields, with the prefix 
		 IF, delimited by the specified character. The default delimiter 
		 is a comma.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 18px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">Filename</p>
                    <p class="Script">[&amp;Import filename = "&lt;FilePath&gt;"]</p>
                    <p style="font-style: normal;">or, to display a screen to select 
		 the file from:</p>
                    <p class="Script">[&amp;Import filename = 'Pick the filename'(filename)]</p>
                    <p>or</p>
                    <p class="Script">[&amp;Assign TF01 = 'Select a file'(filename)]</p>
                    <p>Mandatory parameter that specifies the path of the file to be 
		 imported.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 18px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">IncludeAll</p>
                    <p class="Script">[&amp;Import filename = "&lt;FilePath&gt;",includeall]<br />
		&#160;&#160;...<br /><a name="kanchor1723"></a><a name="kanchor1724"></a><a name="EndImport" id="EndImport"></a>[&amp;EndImport]</p>
                    <p>Sets the output codes or text between the &amp;Import and &amp;EndImport 
		 commands to be viewed for each iteration.</p>
                    <p class="note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #bed230;&quot; class=&quot;mcFormatColor&quot;&gt;Note: &lt;/span&gt;&lt;/b&gt;"><span class="autonumber"><span><b><span style="color: #bed230;" class="mcFormatColor">Note: </span></b></span></span> The default 
		 setting is <span style="font-weight: bold;">noincludeall</span> 
		 which is the default setting on an import loop.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 18px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">Fixed=</p>
                    <p>Defines the record layouts when importing undelimited records. 
		 See <a href="#Examples" class="selected">example 3</a>.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 18px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">Recid=</p>
                    <p>Defines the record type identifier when importing undelimited 
		 records. See <a href="#Examples" class="selected">example 3</a>.</p>
                </td>
            </tr>
        </table>
        <h2>Using Imported Data</h2>
        <p>When an import file is created, the <span style="font-weight: bold;">IF</span> 
 fields in the import file must be matched to database fields in the application. 
 The <a href="&amp;Select_command.htm">&amp;Select</a> command is used to 
 select the database fields to which the data in the <span style="font-weight: bold;">IF</span> 
 fields is assigned.</p>
        <h3>Did the &amp;Select Command Work?</h3>
        <p>The system variable <a href="../Scripting/status,_system_variable_-_error_trapping.htm">Status</a>, 
 returns the status of the last execution of a specified command. In the 
 following example, the status of the &amp;Select command is reported to 
 ensure that no errors occurred whilst the data was being read into the 
 database.</p>
        <p class="Script" style="color: ;">[&amp;SelectEntity int-code =IF02]<br />
[&amp;If Status(selectentity) = ""]<br />
[&amp;Assign EN01=IF03]<br />
[&amp;Else]<br />
[&amp;Message Status(select)]<br />
[&amp;EndIf]</p>
        <p>If the returned value is blank, then the command executed successfully. 
 If an error message is returned, the&#160;command failed.</p>
        <h4><a name="Examples" id="Examples"></a>Example&#160;Scripts</h4>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t3">1 A complete 
 import script</a>
        </p>
        <div MadCap:targetName="t3" style="display: none;">
            <p>This example, part of an &amp;Import script, illustrates the use 
	 of the <span style="font-weight: bold;">&amp;Select MT</span> command.</p>
            <p>The imported fields, prefixed by IF are assigned to temporary fields 
	 for manipulation within the script.</p>
            <p>&amp;Status(Select) looks at the status of the last execution of 
	 the &amp;Select command: if the returned value is blank, then the 
	 command executed correctly; an error message indicates that the&#160;&amp;Select 
	 command failed.</p>
            <p class="Script">######################################################<br />
	### &#160;&#160;Created by: AEK (Visualfiles)Date: 
	 21/06/01 ###### Last Amended by: Date: 
	 ###### Changes made: Date: 
	 #########################################################</p>
            <p class="Script"># Test Script for Import</p>
            <p class="Script">[&amp;Assign TF10 = "D:\testdat\] # Set</p>
            <p class="Script"># Time Loop</p>
            <p class="Script">[&amp;Out TF01:"Time Import for MKBC started at:  + TIME,append][Out TF01: ,append][Import filename = TF02,Delimiter = TF05][Assign TF08 = TF08 + 1] # Add one to 
	 Lines read counter</p>
            <p class="Script"># Set Input Fields</p>
            <p class="Script">&#160;&#160;&#160;[&amp;Assign TF101 = IF01(text)] 
	 # Case Number<br />
	&#160;&#160;&#160;[&amp;Assign TF102 = IF02(date)] # History Date<br />
	&#160;&#160;&#160;[&amp;Assign TF103 = IF04(text)] # narrative<br />
	&#160;&#160;&#160;[&amp;Assign TF104 = IF05(number)]<br />
	&#160;&#160;&#160;[&amp;Select MT,code = TF101,Field = ADC01] # Search 
	 field on old number</p>
            <p class="Script">&#160;&#160;&#160;[&amp;If Status(Select) 
	  ][Out TF01:File not found: 
	  + TF101 + - + TF101, append][Assign TF06 = TF06 + 1] # 
	 Increase Errors by one[Else][History TF103;TF103,date 
	 = TF102][Select</p>
            <p class="Script">[&amp;Out TF01:"No of Time Items: " + TF07,append]<br />
	[&amp;Out TF01:" ",append]<br />
	[&amp;Out TF01:"No of Processed Items: " + TF08,append]<br />
	[&amp;Out TF01:" ",append]<br />
	[&amp;Out TF01:"No of Errors: " + TF06,append]<br />
	[&amp;Out TF01:" ",append]<br />
	[&amp;Out TF01:"Import Finished: " + TIME,append]<br />
	[&amp;Out TF01:"--------------------------------------------------",append]</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t2">2 carriage 
 returns</a>
        </p>
        <div MadCap:targetName="t2" style="display: none;">
            <p class="Script">"FastTrack","6","","testClose","GrangePark","Leeds","","ABC","1AB","2","Mrs","Test","Test","Married","019991234567"</p>
            <p>In this example, if a carriage return did not exist after "019991234567" 
	 none of the information would be imported into Visualfiles, so please 
	 ensure a carriage return is in place.</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t1">3 Define 
 record types when importing undelimited records</a>
        </p>
        <div MadCap:targetName="t1" style="display: none;">
            <p class="Script">[&amp;Import includeall,filename="c:\tmp\myfile", 
	 recid="4,2" ,fixed="AA:3,2,2,3,4" ,fixed="BB:3,2,4,3,2" 
	 ,fixed=":3,2,3,3,3"] &#160;</p>
            <p>This script defines the 2 characters starting at character position 
	 4 as the record type identifier and then defines 3 record layouts, 
	 for the first 2 when the <span style="font-weight: bold;">recid</span> 
	 characters are AA and BB respectively and the last being a default 
	 record layout for any other records encountered. If no default record 
	 layout is specified then unrecognised records are ignored.</p>
        </div>
        <p class="RelatedInfoHead">
            <img src="../redboxes.GIF" alt="" style="border: none;" /> <b>See also:</b></p>
        <ul>
            <li value="1"><a href="../Scripting/status,_system_variable_-_error_trapping.htm">Status, 
	 System Variable - Error Trapping</a>
            </li>
        </ul>
        <div class="FooterTable">
            <table style="width: 100%;mc-table-style: url('../Resources/TableStyles/SimpleDarkBackground.css');margin-left: 0;margin-right: auto;" cellspacing="0" class="TableStyle-SimpleDarkBackground" summary="LexisNexis Visualfiles Information">
                <col style="width: 50%;" class="TableStyle-SimpleDarkBackground-Column-Column1" />
                <col class="TableStyle-SimpleDarkBackground-Column-Column1" style="width: 50%;" />
                <tbody>
                    <tr class="TableStyle-SimpleDarkBackground-Body-Row1">
                        <td class="TableStyle-SimpleDarkBackground-BodyB-Column1-Row1">
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_0" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Follow Us</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_0" style="display: none;">
                                    <p style="text-align: left;margin-top: 0;"><a href="https://twitter.com/LexisNexisES" class="Image" target="_blank" title="LexisNexis Enterprise Solutions" alt="LexisNexis Enterprise Solutions"><img src="../Resources/Images/twitter_icon_32x32.png" class="NoThumbnailHyperlinkedImage" alt="Twitter" /></a><a href="https://www.linkedin.com/groups/4909675" class="Image" target="_blank" title="Visualfiles" alt="LexisNexis"> <img src="../Resources/Images/linkedin_icon_32x32.png" class="NoThumbnailHyperlinkedImage" alt="LexisNexis LinkedIn" /></a> <a href="https://www.linkedin.com/company/2206" class="Image" target="_blank" title="LexisNexis" alt="LexisNexis"> <img src="../Resources/Images/linkedin_icon_32x32.png" class="NoThumbnailHyperlinkedImage" alt="LexisNexis LinkedIn" /></a> <a href="http://www.lexisnexis-es.co.uk/blog/" class="Image" target="_blank" title="LexisNexis Enterprise Solutions Blog" alt="LexisNexis Enterprise Solutions Blog"><img src="../Resources/Images/LN_KnowledgeBurst.png" class="NoThumbnailHyperlinkedImage" alt="LexisNexis" /></a></p>
                                </div>
                            </div>
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_1" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Visualfiles Feature Videos</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_1" style="display: none;">
                                    <p class="FooterTopicMaster"><a href="../Videos_-_Feature_Overviews.htm" target="_self">Videos Feature Overviews</a>
                                    </p>
                                </div>
                            </div>
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_2" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Documentation Feedback</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_2" style="display: none;">
                                    <p class="FooterTopicMaster">We update documentation based on your feedback. Please email your comments and suggestions to <script type="text/javascript">/*<![CDATA[*/var email=('documentation@lexisnexis.co.uk');
											var subject = "Feedback from Topic: " + escape(document.title);
											document.write('<a href="mailto:' + email +
									'?subject=' +subject+ '">' + 'Documentation Feedback' + '<'+'/a>');/*]]>*/</script>.</p>
                                </div>
                            </div>
                        </td>
                        <td class="TableStyle-SimpleDarkBackground-BodyA-Column1-Row1">
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_3" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Customer Support </a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_3" style="display: none;">
                                    <p class="FooterTopicMaster">Customer Support Portal <a href="http://www.essupport.lexisnexis.co.uk/portal/" target="_blank" class="footermasterlarge">http://www.essupport.lexisnexis.co.uk/portal/</a></p>
                                    <p class="FooterTopicMaster">Customer Support Phone: <span class="PrimaryCompanySupportPhoneNumber">+44(0)203 364 4555</span></p>
                                </div>
                            </div>
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_4" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Company Information</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_4" style="display: none;">
                                    <p class="FooterTopicMaster"><span class="PrimaryCompanyName">LexisNexis</span>
                                    </p>
                                    <p class="FooterTopicMaster"><span class="PrimaryCompanyStreetAddress">No. 3 City West Business Park, Gelderd Road</span>
                                    </p>
                                    <p class="FooterTopicMaster"><span class="PrimaryCompanyCityPostcode">Leeds, LS12 6LN</span>
                                    </p>
                                    <p class="FooterTopicMaster"><span class="PrimaryCompanyPhoneNumber">0113 2262031</span>
                                    </p>
                                </div>
                            </div>
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_5" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Product Information</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_5" style="display: none;">
                                    <p class="FooterTopicMaster"><span class="PrimaryProductFullName">Lexis® Visualfiles™</span> <span class="PrimaryProductVersionNumber">3.7</span></p>
                                    <p class="FooterTopicMaster">Copyright © <span class="PrimaryProductReleaseYear">2017</span>&#160;<span class="PrimaryCompanyName">LexisNexis</span>. All rights reserved.</p>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <script type="text/javascript" src="../SkinSupport/MadCapBodyEnd.js">
        </script>
    </body>
</html>