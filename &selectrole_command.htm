<?xml version="1.0" encoding="Windows-1252"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:ignoredWords="essupport" MadCap:tocPath="Development|Commands Reference|Commands" MadCap:InPreviewMode="false" MadCap:PreloadImages="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="HtmlHelp" MadCap:PathToHelpSystem="../" MadCap:HelpSystemFileName="vfiles.xml" MadCap:SearchType="Stem">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=7,8,9,10" />
        <meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
        <meta http-equiv="Content-Language" content="en-UK" /><title>&amp;SelectRole</title>
        <link href="../SkinSupport/Slideshow.css" rel="stylesheet" />
        <link href="../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../Resources/TableStyles/SimpleDarkBackground.css" rel="stylesheet" />
        <link href="../Resources/Stylesheets/styles.css" rel="stylesheet" />
        <script src="../SkinSupport/jquery.js">
        </script>
        <script src="../SkinSupport/MadCapGlobal.js">
        </script>
        <script src="../SkinSupport/MadCapSlideshow.js">
        </script>
        <script src="../SkinSupport/MadCapMerging.js">
        </script>
        <script src="../SkinSupport/MadCapAliasFile.js">
        </script>
        <script src="../SkinSupport/MadCapUtilities.js">
        </script>
        <script src="../SkinSupport/MadCapEffects.js">
        </script>
        <script src="../SkinSupport/MadCapEffectsMenu.js">
        </script>
        <script src="../SkinSupport/MadCapBody.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapHighlighter.js" type="text/javascript">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../Development.htm">Development</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../Commands_Reference.htm">Commands Reference</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="Commands.htm">Commands</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">&amp;SelectRole</span>
        </div>
        <h1><a name="kanchor793"></a>&amp;SelectRole</h1>
        <h2>Syntax &#160;&#160;&#160;<a href="../Scripting/Syntax_Notation.htm" title="Syntax Notation"><img src="../Images/Icon_Info.png" alt="" style="border: none;" /></a></h2>
        <p class="Script">[&amp;SelectRole type = "&lt;RoleCode&gt;"]</p>
        <p><a href="#Examples" class="selected">Example&#160;Scripts</a>
        </p>
        <h2>Description</h2>
        <p>Selects a role from the database.</p>
        <table style="left: 0px;top: 13px;margin-top: 10px;" cellspacing="0" width="100%">
            <col style="width: 100%;" />
            <tr style="vertical-align: top;height: 18px;">
                <td style="border: Solid 1px #c0c0c0;background-attachment: scroll;background-image: url('../BckgrdBCT.gif');background-repeat: Repeat-X;width: 100%;padding-right: 10px;padding-left: 10px;" background="../BckgrdBCT.gif" bgcolor="#FFFFFF">
                    <p class="TableBannerHeading">Parameters</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 18px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">delete</p>
                    <p>Delete a role for a particular entity.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 18px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">code = "&lt;Data&gt;"</p>
                    <p>The <span style="font-weight: bold;">code</span> and <span style="font-weight: bold;">field</span> 
		 parameters are used together to identify a role by the contents 
		 of a specific field.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 18px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">field = "&lt;IndexedField&gt;",code 
		 = "&lt;Data&gt;"</p>
                    <p>The <span style="font-weight: bold;">field</span> and <span style="font-weight: bold;">code</span> parameters are used together 
		 to identify a role by both the field and the content of that field.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 18px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script"><a name="ref" id="ref"></a>ref 
		 = "&lt;TextString&gt;"</p>
                    <p>Assign the selected role a reference.</p>
                    <p>The <span style="font-weight: bold;">ref</span> parameter provides 
		 a quick reference to the selected role that can be used through 
		 the remainder of the script.</p>
                </td>
            </tr>
            <tr style="vertical-align: top;height: 18px;">
                <td style="border-left: Solid 1px #c0c0c0;border-right: Solid 1px #c0c0c0;border-bottom: Solid 1px #c0c0c0;width: 100%;padding-right: 10px;padding-left: 10px;">
                    <p class="Script">type = "&lt;RoleCode&gt;"</p>
                    <p>The type of role to be selected.</p>
                    <p>This command only works if the <a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t5">default owner</a> 
		 is an entity that is able to hold that role. The role then becomes 
		 the default owner (current record). This is <span style="font-weight: bold;">only</span> 
		 allowed in system scripts.</p>
                    <div MadCap:targetName="t5" style="display: none;">
                        <p>The concept of 'default owner' is fundamental to scripting 
			 in Visualfiles. The default owner is the file, entity or role 
			 in which a script is located at a given point in time during 
			 the processing of the script. The default owner changes as 
			 the script moves through the elements in the system.</p>
                        <p>System scripts, by nature, have no default owner and &#160;will 
			 inherit the last accessed component as the owner as the script 
			 progresses.</p>
                        <p>For example, in very simple terms, say you have a &#160;system 
			 &#160;script that starts at an entity then references a role 
			 and, finally, selects a file.</p>
                        <p>As the script is processed, and the role is referenced, 
			 ownership is transferred to that role and it becomes the default 
			 owner. Similarly, as the script is processed and the file 
			 is selected, the file will be the default owner. &#160;</p>
                        <p>The default owner &#160;for all other scripts will be the 
			 &#160;file, &#160;entity or role &#160;&#160;where the processing 
			 starts, but as with system scripts this can be changed using 
			 the &amp;With command.</p>
                    </div>
                </td>
            </tr>
        </table>
        <h4><a name="Examples" id="Examples"></a>Example&#160;Scripts</h4>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t4">1 Select 
 a role of type, CLIENT</a>
        </p>
        <div MadCap:targetName="t4" style="display: none;">
            <p class="Script">[&amp;SelectRole type = "CLIENT"]</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t3">2 Using 
 field and code parameters</a>
        </p>
        <div MadCap:targetName="t3" style="display: none;">
            <p>This example selects the role <span style="font-weight: bold;">EVALUATION</span> 
	 which has a field code of <span style="font-weight: bold;">EVA01</span> 
	 that contains the value <span style="font-weight: bold;">Yes</span>.</p>
            <p class="Script">[&amp;SelectRole type = "EVALUATION",field 
	 = "EVA01",code = "Yes"]</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t2">3 Using 
 the ref parameter</a>
        </p>
        <div MadCap:targetName="t2" style="display: none;">
            <p>This code selects the role <span style="font-weight: bold;">CUSTOMER</span> 
	 for the current entity and gives the role a reference, &#160;<span style="font-weight: bold;">myCUST</span>. It then assigns the value 
	 <span style="font-weight: bold;">Engaged</span> to the field <span style="font-weight: bold;">ABC01</span> for the current role.</p>
            <p class="Script">[&amp;SelectRole type = "CUSTOMER",ref 
	 = "myCUST"]</p>
            <p class="Script">[&amp;Assign myCUST.ABC01 = "Engaged"]</p>
        </div>
        <p><a href="javascript:void(0);" onclick="FMCToggler( this ); return false;" class="MCToggler_0" MadCap:targets="t1">4 Using 
 the delete parameter</a>
        </p>
        <div MadCap:targetName="t1" style="display: none;">
            <p>This example deletes the role with type <span style="font-weight: bold;">ARTIST</span> 
	 from the current entity, <span style="font-weight: bold;">Individual</span>, 
	 which has the code <span style="font-weight: bold;">INDI</span>.</p>
            <p class="Script">[&amp;With INDI]</p>
            <p class="Script">&#160;&#160;&#160;[&amp;SelectRole type = "ARTIST",delete]</p>
            <p class="Script">[&amp;EndWith]</p>
        </div>
        <h4>Developers' tips</h4>
        <p><a name="kanchor794"></a>To use &amp;SelectRole commands in scripts other than system scripts, 
 the <a href="#ref" style="font-weight: normal;" class="selected">ref</a> parameter must 
 be used.</p>
        <p>There are circumstances in which this command will not work, for example, 
 if the current entity does not hold the specified role.</p>
        <h3>Did the &amp;SelectRole Command Work?</h3>
        <p>The system variable <a href="../Scripting/status,_system_variable_-_error_trapping.htm">Status</a> 
 is used to trap errors and return the status of the last execution of 
 a specified command.</p>
        <p>In the following example, the status of the &amp;Selectrole command 
 is reported to check if any errors occurred during execution using: <span class="ScriptChar">&amp;If status(selectrole)=""</span></p>
        <p class="note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #bed230;&quot; class=&quot;mcFormatColor&quot;&gt;Note: &lt;/span&gt;&lt;/b&gt;"><span class="autonumber"><span><b><span style="color: #bed230;" class="mcFormatColor">Note: </span></b></span></span> The &amp;SelectRole 
 command must have been referenced for the error trapping command status(selectrole) 
 to work.<br />
If the Role that is being selected already exists then the reference is 
 not required.</p>
        <p class="Script" style="color: ;">[&amp;SelectRole type="ALLCLIENTS",ref="myCLIENT"]</p>
        <p class="Script" style="color: ;">** Test if role exists</p>
        <p class="Script" style="color: ;">[&amp;If status(selectrole)=""]</p>
        <p class="Script" style="color: ;">&#160;&#160;&#160;[&amp;Assign FIL04="Add 
 Matter,FIL-ADDFILE,"] &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</p>
        <p class="Script" style="color: ;">** Change the button to add a file &#160;&#160;&#160;</p>
        <p class="Script">[&amp;EndIf]</p>
        <p>If the returned value is blank, then the command executed successfully. 
 If an error message is returned, the&#160;command failed.</p>
        <p class="RelatedInfoHead">
            <img src="../redboxes.GIF" alt="" style="border: none;" /> <b>See also:</b></p>
        <ul>
            <li value="1"><a href="../Scripting/status,_system_variable_-_error_trapping.htm">Status, 
	 System Variable - Error Trapping</a>
            </li>
        </ul>
        <div class="FooterTable">
            <table style="width: 100%;mc-table-style: url('../Resources/TableStyles/SimpleDarkBackground.css');margin-left: 0;margin-right: auto;" cellspacing="0" class="TableStyle-SimpleDarkBackground" summary="LexisNexis Visualfiles Information">
                <col style="width: 50%;" class="TableStyle-SimpleDarkBackground-Column-Column1" />
                <col class="TableStyle-SimpleDarkBackground-Column-Column1" style="width: 50%;" />
                <tbody>
                    <tr class="TableStyle-SimpleDarkBackground-Body-Row1">
                        <td class="TableStyle-SimpleDarkBackground-BodyB-Column1-Row1">
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_0" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Follow Us</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_0" style="display: none;">
                                    <p style="text-align: left;margin-top: 0;"><a href="https://twitter.com/LexisNexisES" class="Image" target="_blank" title="LexisNexis Enterprise Solutions" alt="LexisNexis Enterprise Solutions"><img src="../Resources/Images/twitter_icon_32x32.png" class="NoThumbnailHyperlinkedImage" alt="Twitter" /></a><a href="https://www.linkedin.com/groups/4909675" class="Image" target="_blank" title="Visualfiles" alt="LexisNexis"> <img src="../Resources/Images/linkedin_icon_32x32.png" class="NoThumbnailHyperlinkedImage" alt="LexisNexis LinkedIn" /></a> <a href="https://www.linkedin.com/company/2206" class="Image" target="_blank" title="LexisNexis" alt="LexisNexis"> <img src="../Resources/Images/linkedin_icon_32x32.png" class="NoThumbnailHyperlinkedImage" alt="LexisNexis LinkedIn" /></a> <a href="http://www.lexisnexis-es.co.uk/blog/" class="Image" target="_blank" title="LexisNexis Enterprise Solutions Blog" alt="LexisNexis Enterprise Solutions Blog"><img src="../Resources/Images/LN_KnowledgeBurst.png" class="NoThumbnailHyperlinkedImage" alt="LexisNexis" /></a></p>
                                </div>
                            </div>
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_1" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Visualfiles Feature Videos</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_1" style="display: none;">
                                    <p class="FooterTopicMaster"><a href="../Videos_-_Feature_Overviews.htm" target="_self">Videos Feature Overviews</a>
                                    </p>
                                </div>
                            </div>
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_2" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Documentation Feedback</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_2" style="display: none;">
                                    <p class="FooterTopicMaster">We update documentation based on your feedback. Please email your comments and suggestions to <script type="text/javascript">/*<![CDATA[*/var email=('documentation@lexisnexis.co.uk');
											var subject = "Feedback from Topic: " + escape(document.title);
											document.write('<a href="mailto:' + email +
									'?subject=' +subject+ '">' + 'Documentation Feedback' + '<'+'/a>');/*]]>*/</script>.</p>
                                </div>
                            </div>
                        </td>
                        <td class="TableStyle-SimpleDarkBackground-BodyA-Column1-Row1">
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_3" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Customer Support </a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_3" style="display: none;">
                                    <p class="FooterTopicMaster">Customer Support Portal <a href="http://www.essupport.lexisnexis.co.uk/portal/" target="_blank" class="footermasterlarge">http://www.essupport.lexisnexis.co.uk/portal/</a></p>
                                    <p class="FooterTopicMaster">Customer Support Phone: <span class="PrimaryCompanySupportPhoneNumber">+44(0)203 364 4555</span></p>
                                </div>
                            </div>
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_4" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Company Information</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_4" style="display: none;">
                                    <p class="FooterTopicMaster"><span class="PrimaryCompanyName">LexisNexis</span>
                                    </p>
                                    <p class="FooterTopicMaster"><span class="PrimaryCompanyStreetAddress">No. 3 City West Business Park, Gelderd Road</span>
                                    </p>
                                    <p class="FooterTopicMaster"><span class="PrimaryCompanyCityPostcode">Leeds, LS12 6LN</span>
                                    </p>
                                    <p class="FooterTopicMaster"><span class="PrimaryCompanyPhoneNumber">0113 2262031</span>
                                    </p>
                                </div>
                            </div>
                            <div class="MCDropDown_0">
                                <div class="MCDropDownHead_0"><a class="MCDropDownHotSpot_Footer_0" href="javascript:void(0);" id="MCDropDownHotSpot_2717374667_5" onclick="FMCDropDown( this ); return false;"><img style="border: none;margin-right: 5px;" src="../SkinSupport/DropDownClosed.png" MadCap:altsrc="../SkinSupport/DropDownOpen.png" onload="if ( typeof( FMCPreloadImage ) == 'function' ) { FMCPreloadImage( '../../SkinSupport/DropDownOpen.png' ); }" alt="Closed" MadCap:alt2="Open" class="MCDropDownIcon" />Product Information</a>
                                </div>
                                <div class="MCDropDownBody_0" id="MCDropDownBody_2717374667_5" style="display: none;">
                                    <p class="FooterTopicMaster"><span class="PrimaryProductFullName">Lexis® Visualfiles™</span> <span class="PrimaryProductVersionNumber">3.7</span></p>
                                    <p class="FooterTopicMaster">Copyright © <span class="PrimaryProductReleaseYear">2017</span>&#160;<span class="PrimaryCompanyName">LexisNexis</span>. All rights reserved.</p>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <script type="text/javascript" src="../SkinSupport/MadCapBodyEnd.js">
        </script>
    </body>
</html>